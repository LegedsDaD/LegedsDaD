name: MAX MODE AI WAR

on:
  schedule:
    - cron: "0 */12 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:

      - name: Checkout output branch
        uses: actions/checkout@v4
        with:
          ref: output
        continue-on-error: true

      - name: Create dist folder
        run: mkdir -p dist

      ###################################################
      # Generate Contribution Snake
      ###################################################

      - name: Generate snake
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ github.repository_owner }}
          outputs: dist/snake.svg

      ###################################################
      # Generate MAX MODE SVG
      ###################################################

      - name: Generate MAX MODE HUD
        run: |
          cat <<'EOF' > dist/max-mode-ai-war.svg

          <svg xmlns="http://www.w3.org/2000/svg"
               width="1100"
               height="450"
               viewBox="0 0 1100 450">

          <style>

          /* GRID */
          .grid line {
            stroke:#00ffee;
            stroke-width:0.4;
            opacity:0.15;
            animation:gridMove 12s linear infinite;
          }

          @keyframes gridMove {
            from { transform:translateY(0); }
            to { transform:translateY(60px); }
          }

          /* ROBOT WALK */
          .robot {
            animation:robotWalk 12s infinite linear;
          }

          @keyframes robotWalk {
            0% { transform:translateX(0px); }
            50% { transform:translateX(850px); }
            100% { transform:translateX(0px); }
          }

          /* DRONES */
          .drone {
            animation:droneFly 8s infinite linear;
          }

          @keyframes droneFly {
            0% { transform:translateX(0px) translateY(0px); }
            50% { transform:translateX(1000px) translateY(30px); }
            100% { transform:translateX(0px) translateY(0px); }
          }

          /* LASER */
          .laser {
            stroke:#ff0044;
            stroke-width:3;
            stroke-dasharray:12;
            animation:laser 0.4s infinite linear;
          }

          @keyframes laser {
            from { stroke-dashoffset:20; }
            to { stroke-dashoffset:0; }
          }

          /* RADAR */
          .radar circle {
            fill:none;
            stroke:#00ffee;
            stroke-width:2;
            animation:radar 3s infinite;
          }

          @keyframes radar {
            0% { r:10; opacity:1; }
            100% { r:100; opacity:0; }
          }

          /* TARGET ROTATE */
          .target {
            stroke:#00ffee;
            stroke-width:2;
            fill:none;
            animation:spin 6s infinite linear;
            transform-origin:center;
          }

          @keyframes spin {
            from { transform:rotate(0deg); }
            to { transform:rotate(360deg); }
          }

          /* POWER BAR */
          .power {
            fill:#00ff88;
            animation:powerUp 4s infinite alternate;
          }

          @keyframes powerUp {
            from { width:100px; }
            to { width:350px; }
          }

          /* BOSS HEALTH */
          .health {
            fill:#ff0033;
            animation:healthDrain 6s infinite alternate;
          }

          @keyframes healthDrain {
            from { width:350px; }
            to { width:50px; }
          }

          /* KILL COUNTER */
          .counter {
            fill:#00ffee;
            font-family:monospace;
            font-size:18px;
            animation:flicker 2s infinite;
          }

          @keyframes flicker {
            0%,100% { opacity:1; }
            50% { opacity:0.4; }
          }

          </style>


          <!-- GRID -->
          <g class="grid">
            <line x1="0" y1="80" x2="1100" y2="80"/>
            <line x1="0" y1="140" x2="1100" y2="140"/>
            <line x1="0" y1="200" x2="1100" y2="200"/>
            <line x1="0" y1="260" x2="1100" y2="260"/>
            <line x1="0" y1="320" x2="1100" y2="320"/>
          </g>


          <!-- Snake -->
          <image href="snake.svg"
                 x="0"
                 y="120"
                 width="1100"
                 height="200"/>


          <!-- Robot Army -->
          <g class="robot">
            <rect x="50" y="150" width="50" height="60" fill="#00ffee"/>
            <circle cx="85" cy="180" r="6" fill="red"/>
            <line x1="100" y1="180" x2="1050" y2="180" class="laser"/>
          </g>


          <!-- Drones -->
          <g class="drone">
            <rect x="100" y="40" width="40" height="15" fill="#00ffee"/>
            <circle cx="120" cy="60" r="4" fill="red"/>
          </g>


          <!-- Explosion -->
          <circle cx="1050" cy="180" r="10" fill="red">
            <animate attributeName="r"
                     values="5;30;5"
                     dur="0.5s"
                     repeatCount="indefinite"/>
          </circle>


          <!-- Radar -->
          <g class="radar">
            <circle cx="1000" cy="60"/>
          </g>


          <!-- Target -->
          <circle cx="1050" cy="180" r="60" class="target"/>


          <!-- Power Level -->
          <text x="20" y="30" fill="#00ffee">AI POWER</text>
          <rect x="20" y="40" height="15" class="power"/>


          <!-- Boss Health -->
          <text x="20" y="90" fill="#ff0033">BOSS HP</text>
          <rect x="20" y="100" height="15" class="health"/>


          <!-- Kill Counter -->
          <text x="20" y="420" class="counter">
            KILLS: 999+
          </text>

          </svg>

          EOF


      - name: Commit
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add dist/*.svg
          git commit -m "Activate MAX MODE AI WAR" || echo "No changes"

      - name: Push
        uses: ad-m/github-push-action@master
        with:
          branch: output
          github_token: ${{ secrets.GITHUB_TOKEN }}
